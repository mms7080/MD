<!DOCTYPE html>
<html lang="ko" data-theme="light" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>프로필 – kafolio</title>

    <!-- 기존 공통 리소스 경로 유지 -->
    <link rel="stylesheet" th:href="@{/css/header.css}" />
    <link rel="stylesheet" th:href="@{/css/footer.css}" />
    <!-- 마이페이지/프로필 전용 (있다면) -->
    <link rel="stylesheet" th:href="@{/css/mypage/mypage.css}" />

    <!-- 페이지 스코프 전용 스타일: 접두사 .prof- 로 충돌 방지 -->
    <style>
      .prof-shell { max-width: 980px; margin: 28px auto; padding: 0 16px; }
      .prof-head { display:flex; align-items:center; gap:16px; margin-bottom:16px; }
      .prof-avatar { width:96px; height:96px; border-radius:50%; background:#e5e7eb; overflow:hidden; display:flex; align-items:center; justify-content:center; font-weight:700; }
      .prof-avatar img { width:100%; height:100%; object-fit:cover; }
      .prof-name { font-size:22px; font-weight:800; }
      .prof-meta { color:#6b7280; font-size:14px; margin-top:4px; }
      .prof-grid { display:grid; grid-template-columns: 1fr 1fr; gap:16px; }
      @media (max-width: 900px){ .prof-grid { grid-template-columns: 1fr; } }
      .prof-card { background:#fff; border:1px solid #e5e7eb; border-radius:14px; padding:16px; }
      .prof-card h2 { font-size:18px; font-weight:700; margin:0 0 10px; }
      .prof-card h3 { font-size:16px; font-weight:700; margin:0 0 10px; }
      .prof-label { display:block; margin:8px 0 4px; font-weight:600; }
      .prof-input, .prof-select { width:100%; border:1px solid #d1d5db; border-radius:10px; padding:10px; }
      .prof-btns { display:flex; gap:8px; margin-top:10px; }
      .btn-primary { background:#111827; color:#fff; border:0; padding:10px 14px; border-radius:10px; cursor:pointer; }
      .btn-ghost { background:#fff; color:#111827; border:1px solid #d1d5db; padding:10px 14px; border-radius:10px; cursor:pointer; }
      .btn-danger { background:#ef4444; color:#fff; border:0; padding:10px 14px; border-radius:10px; cursor:pointer; }
      .prof-note { font-size:12px; color:#6b7280; margin-top:6px; }
      .prof-note.ok { color:#10b981; }
      .prof-note.err { color:#ef4444; }
      .prof-divider { height:1px; background:#e5e7eb; margin:16px 0; }
    </style>
  </head>

  <body>
    <!-- ✅ 공통 헤더: 기존 프래그먼트 그대로 -->
    <th:block th:replace="fragments/header :: header('mypage')"></th:block>

    <main class="prof-shell">
      <!-- 상단 프로필 요약 -->
      <section class="prof-card" aria-labelledby="profileSummaryTitle">
        <div class="prof-head">
          <div class="prof-avatar">
            <img th:src="@{/images/avatar-default.png}" alt="프로필 이미지" />
          </div>
          <div>
            <div id="profileSummaryTitle" class="prof-name">홍길동</div>
            <div class="prof-meta">hong@example.com · 일반 모드</div>
            <div class="prof-meta">가입일: 2024-11-02 · 성별: 남성</div>
          </div>
        </div>
      </section>

      <div style="height:12px;"></div>

      <!-- 프로필 수정 + 비밀번호 변경 -->
      <section class="prof-grid">
        <!-- 프로필 수정(성별/모드) -->
        <article class="prof-card" aria-labelledby="profileEditTitle">
          <h2 id="profileEditTitle">프로필 수정</h2>
          <label class="prof-label" for="gender">성별</label>
          <select id="gender" class="prof-select">
            <option selected>남성</option>
            <option>여성</option>
            <option>선택 안 함</option>
          </select>

          <label class="prof-label" for="mode" style="margin-top:8px;">모드</label>
          <select id="mode" class="prof-select">
            <option selected>일반</option>
            <option>학생</option>
          </select>

          <div class="prof-btns">
            <button type="button" class="btn-primary" id="btnSaveProfile">저장</button>
            <button type="button" class="btn-ghost" id="btnResetProfile">초기화</button>
          </div>
          <p class="prof-note" id="profileMsg" aria-live="polite"></p>
        </article>

        <!-- 비밀번호 변경 -->
        <article class="prof-card" aria-labelledby="pwChangeTitle">
          <h2 id="pwChangeTitle">비밀번호 변경</h2>

          <label class="prof-label" for="curPw">현재 비밀번호</label>
          <input type="password" id="curPw" class="prof-input" placeholder="현재 비밀번호" />

          <label class="prof-label" for="newPw" style="margin-top:8px;">새 비밀번호</label>
          <input type="password" id="newPw" class="prof-input" placeholder="8자 이상" />

          <label class="prof-label" for="newPw2" style="margin-top:8px;">새 비밀번호 확인</label>
          <input type="password" id="newPw2" class="prof-input" placeholder="다시 입력" />

          <div class="prof-btns">
            <button type="button" class="btn-primary" id="btnChangePw">변경</button>
            <button type="button" class="btn-ghost" id="btnResetPw">초기화</button>
          </div>
          <p class="prof-note" id="pwMsg" aria-live="polite"></p>
        </article>
      </section>

      <div class="prof-divider" role="presentation"></div>

      <!-- 위험 영역(하드코딩 안내용) -->
      <section class="prof-card" aria-labelledby="dangerTitle">
        <h2 id="dangerTitle">계정 위험 영역</h2>
        <p class="prof-note">아래 동작은 예시용 UI입니다. 실제 삭제는 백엔드 연동 후에만 가능합니다.</p>
        <button type="button" class="btn-danger" id="btnDelete">회원 탈퇴</button>
        <p class="prof-note" id="delMsg" aria-live="polite"></p>
      </section>
    </main>

    <!-- ✅ 공통 푸터: 기존 프래그먼트 그대로 -->
    <th:block th:replace="fragments/footer :: footer"></th:block>

    <!-- 하드코딩 동작만 처리하는 경량 스크립트 -->
    <script>
      // 초기 값(하드코딩)
      const init = { gender: "남성", mode: "일반" };

      // 프로필 저장(프론트만)
      const genderEl = document.getElementById("gender");
      const modeEl = document.getElementById("mode");
      const profileMsg = document.getElementById("profileMsg");

      document.getElementById("btnSaveProfile")?.addEventListener("click", () => {
        const g = genderEl.value;
        const m = modeEl.value;
        profileMsg.textContent = `저장됨 (가상): 성별=${g}, 모드=${m}`;
        profileMsg.className = "prof-note ok";
      });
      document.getElementById("btnResetProfile")?.addEventListener("click", () => {
        genderEl.value = init.gender;
        modeEl.value = init.mode;
        profileMsg.textContent = "입력값이 초기화되었습니다.";
        profileMsg.className = "prof-note";
      });

      // 비밀번호 변경(프론트 검증만)
      const pwMsg = document.getElementById("pwMsg");
      document.getElementById("btnChangePw")?.addEventListener("click", () => {
        const cur = document.getElementById("curPw").value.trim();
        const n1 = document.getElementById("newPw").value.trim();
        const n2 = document.getElementById("newPw2").value.trim();

        if (!cur || !n1 || !n2) {
          pwMsg.textContent = "모든 필드를 입력하세요.";
          pwMsg.className = "prof-note err";
          return;
        }
        if (n1.length < 8) {
          pwMsg.textContent = "새 비밀번호는 8자 이상이어야 합니다.";
          pwMsg.className = "prof-note err";
          return;
        }
        if (n1 !== n2) {
          pwMsg.textContent = "새 비밀번호가 일치하지 않습니다.";
          pwMsg.className = "prof-note err";
          return;
        }
        pwMsg.textContent = "변경 완료 (가상). 실제 반영은 백엔드 연동 필요.";
        pwMsg.className = "prof-note ok";
      });
      document.getElementById("btnResetPw")?.addEventListener("click", () => {
        ["curPw","newPw","newPw2"].forEach(id => document.getElementById(id).value = "");
        pwMsg.textContent = "입력값이 초기화되었습니다.";
        pwMsg.className = "prof-note";
      });

      // 탈퇴(프론트 경고만)
      const delMsg = document.getElementById("delMsg");
      document.getElementById("btnDelete")?.addEventListener("click", () => {
        const ok = confirm("정말 탈퇴하시겠습니까? (가상 동작)");
        if (ok) {
          delMsg.textContent = "탈퇴 요청 전송됨 (가상). 백엔드 연동 필요.";
          delMsg.className = "prof-note err";
        }
      });
    </script>
  </body>
</html>
