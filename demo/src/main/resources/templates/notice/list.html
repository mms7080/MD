<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
    <head>
        <meta charset="UTF-8" />
        <title>Í≥µÏßÄÏÇ¨Ìï≠</title>
        <link rel="stylesheet" href="/css/header.css" />
        <link rel="stylesheet" href="/css/footer.css" />
        <link rel="stylesheet" href="/css/notice/list.css" />
        <link rel="stylesheet" href="/css/users/auth-modal.css" />
    </head>
    <body>
        <div th:replace="fragments/modals :: authModals"></div>
        <div th:replace="fragments/header :: header('notice')"></div>

        <main class="notice-container">
            <h1 class="notice-title">Í≥µÏßÄÏÇ¨Ìï≠</h1>

            <!-- Í≤ÄÏÉâ ÏòÅÏó≠ -->
            <div class="notice-search">
                <form
                    th:action="@{/notice}"
                    method="get"
                    style="display: flex; gap: 8px"
                >
                    <select name="type">
                        <option value="title" th:selected="${type == 'title'}">
                            Ï†úÎ™©
                        </option>
                        <option
                            value="writer"
                            th:selected="${type == 'writer'}"
                        >
                            ÏûëÏÑ±Ïûê
                        </option>
                    </select>
                    <input
                        type="text"
                        name="keyword"
                        placeholder="Í≤ÄÏÉâÏñ¥Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî"
                        th:value="${keyword}"
                    />
                    <button type="submit" class="btn-search">Í≤ÄÏÉâ</button>
                    <a th:href="@{/notice}" class="btn-all">Ï†ÑÏ≤¥Î≥¥Í∏∞</a>
                </form>

                <a th:href="@{/notice/new}" class="btn-write">ÏûëÏÑ±ÌïòÍ∏∞</a>
            </div>

            <!-- Í≥µÏßÄÏÇ¨Ìï≠ ÌÖåÏù¥Î∏î -->
            <table class="notice-table">
                <thead>
                    <tr>
                        <th>Î≤àÌò∏</th>
                        <th>Ï†úÎ™©</th>
                        <th>ÏûëÏÑ±Ïûê</th>
                        <th>ÏûëÏÑ±Ïùº</th>
                        <th>Ï°∞ÌöåÏàò</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Í≤ÄÏÉâ Í≤∞Í≥º ÏóÜÏùå -->
                    <tr th:if="${isEmpty}">
                        <td
                            colspan="5"
                            style="
                                text-align: center;
                                padding: 20px;
                                color: var(--muted);
                            "
                        >
                            Í≤ÄÏÉâ Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§.
                        </td>
                    </tr>

                    <!-- Í≤ÄÏÉâ Í≤∞Í≥º ÏûàÏùÑ Îïå -->
                    <tr th:each="notice : ${notices}">
                        <td th:text="${notice.id}"></td>
                        <td class="notice-subject">
                            <a
                                th:href="@{|/notice/${notice.id}|}"
                                th:text="${notice.title}"
                            ></a>

                            <!-- NEW Î±ÉÏßÄ -->
                            <span
                                class="badge-new"
                                th:if="${#temporals.format(notice.createdAt, 'yyyy-MM-dd') == #temporals.format(T(java.time.LocalDate).now(), 'yyyy-MM-dd')}"
                            >
                                NEW
                            </span>
                        </td>
                        <td th:text="${notice.writer}"></td>
                        <td
                            th:text="${#temporals.format(notice.createdAt, 'yyyy.MM.dd')}"
                        ></td>
                        <td th:text="${notice.views}"></td>
                    </tr>
                </tbody>
            </table>

            <!-- üìë ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò -->
            <div class="pagination">
                <!-- Ïù¥Ï†Ñ Î∏îÎ°ù Î≤ÑÌäº -->
                <a
                    th:if="${startPage > 0}"
                    th:href="@{|/notice?page=${startPage - 1}|}"
                    class="page-btn"
                    >&lt;</a
                >

                <!-- ÌéòÏù¥ÏßÄ Î≤àÌò∏ Î≤ÑÌäº -->
                <a
                    th:each="pageNum : ${#numbers.sequence(startPage, endPage)}"
                    th:href="@{|/notice?page=${pageNum}|}"
                    th:text="${pageNum + 1}"
                    th:classappend="${pageNum == currentPage} ? 'active' : ''"
                    class="page-btn"
                ></a>

                <!-- Îã§Ïùå Î∏îÎ°ù Î≤ÑÌäº -->
                <a
                    th:if="${endPage < totalPages - 1}"
                    th:href="@{|/notice?page=${endPage + 1}|}"
                    class="page-btn"
                    >&gt;</a
                >
            </div>
        </main>
        <div th:replace="fragments/footer :: footer"></div>
    </body>

    <script>
        window.onpageshow = function (event) {
            if (event.persisted) {
                window.location.reload();
            }
        };
    </script>
</html>
