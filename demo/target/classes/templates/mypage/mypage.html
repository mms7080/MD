<!DOCTYPE html>
<html lang="ko" data-theme="light" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>마이페이지 – kafolio</title>

  <!-- 공통 헤더 -->
  <link rel="stylesheet" th:href="@{/css/header.css}" />
  <!-- 마이페이지 전용 -->
  <link rel="stylesheet" th:href="@{/css/mypage/mypage.css}" />
  <!-- 반드시 포함(기존 모달 스타일과 충돌 없게 네임스페이스 클래스 사용) -->
  <link rel="stylesheet" th:href="@{/css/users/auth-modal.css}" />
  <link rel="stylesheet" th:href="@{/css/mypage/mypage-modal.css}" />
</head>

<body>
  <!-- 공통 헤더 -->
  <div th:replace="fragments/header :: header('mypage')"></div>

  <!-- 본문: 좌측 레일 + 메인 -->
  <div class="admin-shell">
    <!-- 사이드바 -->
    <aside class="nav-rail">
      <div class="org-name">마이페이지</div>
      <nav class="rail-menu" id="sidebar">
        <a href="/mypage" class="rail-item is-active"><span class="dot"></span>홈</a>
        <a href="/mypage/team" class="rail-item"><span class="dot"></span> 팀 참여 정보</a>
        <a href="#" class="rail-item"><span class="dot"></span> 회원 탈퇴</a>
      </nav>
    </aside>

    <!-- 메인 -->
    <main class="page">
      <div class="page-header">
        <div class="page-titles">
          <h1>마이페이지</h1>
        </div>
      </div>

      <!-- 프로필 카드 -->
      <section class="panel profile-panel">
        <div class="profile-card">
          <div class="avatar">
            <img th:src="@{/images/avatar-default.png}" alt="프로필 이미지" />
          </div>
          <div class="who">
            <h2 th:text="${users.name}">홍길동</h2>
            <div class="meta">
              <span th:text="${users.email}">hong@example.com</span>
            </div>

            <!-- ⬇️ 여기 추가: 회원정보 수정 버튼 -->
            <div class="profile-actions">
              <label for="modal-edit-profile" class="btn">회원정보 수정</label>
            </div>
          </div>
        </div>
      </section>

      <!-- 현황 -->
      <section class="panel">
        <div class="panel-head">
          <h2>나의 현황</h2>
        </div>
        <div class="stat-grid">
          <!-- 포트폴리오 카드 -->
          <article class="stat-card">
            <div class="stat-top">
              <div class="stat-title">포트폴리오</div>
              <div class="stat-badge">총 개수</div>
            </div>
            <div class="stat-num">3</div>
            <ul class="recent-list">
              <li><a href="#">Landing Page 개선</a></li>
              <li><a href="#">Admin UI 디자인</a></li>
              <li><a href="#">React 프로젝트</a></li>
            </ul>
            <div class="stat-foot"><a class="link" href="#">더보기</a></div>
          </article>

          <!-- 자소서 카드 -->
          <article class="stat-card">
            <div class="stat-top">
              <div class="stat-title">자소서</div>
              <div class="stat-badge">총 개수</div>
            </div>
            <div class="stat-num">5</div>
            <ul class="recent-list">
              <li><a href="#">백엔드 개발자 지원서</a></li>
              <li><a href="#">스타트업 자기소개</a></li>
              <li><a href="#">인턴 지원용 자소서</a></li>
            </ul>
            <div class="stat-foot"><a class="link" href="#">더보기</a></div>
          </article>
        </div>
      </section>
    </main>
  </div>

  <!-- ⬇️ 모달 토글 + 모달 본문 (페이지 하단에 배치) -->
  <input type="checkbox" id="modal-edit-profile" />

  <div class="kf-editmodal" aria-hidden="true">
    <!-- 오버레이(클릭 시 닫힘) -->
    <label for="modal-edit-profile" class="kf-editmodal__overlay" aria-label="닫기"></label>

    <!-- 다이얼로그 -->
    <div class="kf-editmodal__dialog" role="dialog" aria-modal="true" aria-labelledby="editProfileTitle">
      <div class="kf-editmodal__header">
        <div id="editProfileTitle" class="kf-editmodal__title">회원정보 수정</div>
        <label for="modal-edit-profile" class="kf-editmodal__close" aria-label="닫기">×</label>
      </div>

      <form th:action="@{/mypage/profile}" method="post">
        <!-- CSRF -->
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

        <table class="kf-formtable">
          <tbody>
            <!-- 읽기 전용: 아이디 -->
            <tr>
              <th scope="row">아이디</th>
              <td>
                <input type="text" th:value="${users.username}" disabled readonly class="ro" />
                <small class="hint">아이디는 변경할 수 없습니다.</small>
              </td>
            </tr>

            <!-- 읽기 전용: 이메일 -->
            <tr>
              <th scope="row">이메일</th>
              <td>
                <input type="text" th:value="${users.email}" disabled readonly class="ro" />
                <small class="hint">이메일은 변경할 수 없습니다.</small>
              </td>
            </tr>

            <!-- 읽기 전용: 성별 -->
            <tr>
              <th scope="row">성별</th>
              <td>
                <input type="text" th:value="${users.gender}" disabled readonly class="ro" />
                <small class="hint">성별은 변경할 수 없습니다.</small>
              </td>
            </tr>

            <!-- 수정 가능: 이름 -->
            <tr>
              <th scope="row">이름</th>
              <td>
                <input type="text" name="name" th:value="${users.name}" placeholder="이름을 입력하세요" required />
              </td>
            </tr>

            <!-- 수정 가능: 나이 -->
            <tr>
              <th scope="row">나이</th>
              <td>
                <input type="number" name="age" th:value="${users.age}" min="0" placeholder="나이" />
              </td>
            </tr>

            <!-- 선택적 변경: 비밀번호 -->
            <tr>
              <th scope="row">비밀번호 변경</th>
              <td>
                <input type="password" name="password" placeholder="새 비밀번호 (변경 시에만 입력)" />
                <div style="height:8px"></div>
                <input type="password" name="confirmPassword" placeholder="새 비밀번호 확인" />
                <small class="hint">비워두면 기존 비밀번호를 유지합니다.</small>
              </td>
            </tr>
          </tbody>
        </table>


        <div class="kf-editmodal__actions">
          <label for="modal-edit-profile" class="btn ghost">취소</label>
          <button type="submit" class="btn primary">저장</button>
        </div>
      </form>
    </div>
  </div>
</body>

</html>