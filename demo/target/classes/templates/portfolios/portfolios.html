<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
    <head>
        <meta charset="UTF-8" />
        <title
            th:text="${portfolios != null} ? portfolios.title : 'Ìè¨Ìä∏Ìè¥Î¶¨Ïò§ ÏóÜÏùå'"
        >
            Portfolio
        </title>
        <meta name="_csrf" th:content="${_csrf.token}" />
        <meta name="_csrf_header" th:content="${_csrf.headerName}" />

        <link rel="stylesheet" href="/css/header.css" />
        <link rel="stylesheet" href="/css/portfolios/portfolios-detail.css" />
        <link rel="stylesheet" href="/css/footer.css" />
        <link rel="stylesheet" href="/css/users/auth-modal.css" />
    </head>
    <body class="portfolio-detail">
        <!-- Ìó§Îçî -->
        <div th:replace="fragments/modals :: authModals"></div>
        <div th:replace="fragments/header :: header('portfolio')"></div>

        <main class="container">
            <!-- ‚ùå Not Found -->
            <div th:if="${notFound}" class="error-box">
                <h1>Ìè¨Ìä∏Ìè¥Î¶¨Ïò§Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.</h1>
                <a href="/home">‚Üê ÌôàÏúºÎ°ú</a>
            </div>

            <!-- ‚úÖ Portfolio Content -->
            <div th:if="${portfolios != null}" class="portfolio-detail-grid">
                <!-- ÏôºÏ™Ω: Ïù¥ÎØ∏ÏßÄ -->
                <div class="gallery">
                    <!-- ÎåÄÌëú Ïù¥ÎØ∏ÏßÄ -->
                    <figure class="main-photo">
                        <img
                            id="mainImage"
                            th:src="${portfolios.screenshots[0]}"
                            alt="ÎåÄÌëú Ïù¥ÎØ∏ÏßÄ"
                        />
                    </figure>

                    <!-- Ïç∏ÎÑ§Ïùº -->
                    <div class="thumb-list">
                        <img
                            th:each="img : ${portfolios.screenshots}"
                            th:src="${img}"
                            alt="Ïç∏ÎÑ§Ïùº"
                            onmouseover="changeMainImage(this.src)"
                        />
                    </div>
                </div>

                <!-- Ïò§Î•∏Ï™Ω: Ï†ïÎ≥¥ -->
                <div class="info-box">
                    <h1 class="title" th:text="${portfolios.title}">Ï†úÎ™©</h1>
                    <p class="desc" th:text="${portfolios.desc}">ÏÑ§Î™Ö</p>

                    <div class="meta-box">
                        <p>
                            <span class="label">Link:</span>
                            <a
                                th:href="${portfolios.link}"
                                target="_blank"
                                th:text="${portfolios.link}"
                                class="custom-link"
                            ></a>
                        </p>

                        <p>
                            <span class="label">Views:</span>
                            <span id="viewCount">0</span>
                        </p>

                        <div class="like-wrap">
                            <!-- Î°úÍ∑∏Ïù∏ ÏÉÅÌÉúÏùº Îïå -->
                            <button
                                sec:authorize="isAuthenticated()"
                                id="likeBtn"
                                class="heart-btn"
                                title="Ï¢ãÏïÑÏöî"
                                aria-label="Ï¢ãÏïÑÏöî"
                                th:attr="data-id=${portfolios.id}"
                            >
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    fill="none"
                                    viewBox="0 0 24 24"
                                    stroke-width="1.5"
                                    stroke="currentColor"
                                    class="heart-icon"
                                >
                                    <path
                                        stroke-linecap="round"
                                        stroke-linejoin="round"
                                        d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 
                       0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 
                       3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"
                                    />
                                </svg>
                                <span
                                    id="likeCount"
                                    th:text="${portfolios.likes}"
                                    >0</span
                                >
                            </button>

                            <!-- ÎπÑÎ°úÍ∑∏Ïù∏ ÏÉÅÌÉúÏùº Îïå -->
                            <a
                                sec:authorize="isAnonymous()"
                                href="/signin"
                                id="likeSigninTrigger"
                                class="like-btn"
                                title="Î°úÍ∑∏Ïù∏ ÌõÑ Ï¢ãÏïÑÏöî Í∞ÄÎä•"
                            >
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    fill="none"
                                    viewBox="0 0 24 24"
                                    stroke-width="1.5"
                                    stroke="currentColor"
                                    class="heart-icon"
                                >
                                    <path
                                        stroke-linecap="round"
                                        stroke-linejoin="round"
                                        d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 
                    0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 
                    3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"
                                    />
                                </svg>
                                <span th:text="${portfolios.likes}">0</span>
                            </a>
                        </div>

                        <!-- üè∑ ÌÉúÍ∑∏ -->
                        <div class="tags">
                            <span class="label">Tags:</span>
                            <div class="tag-wrap">
                                <a
                                    th:each="tag : ${portfolios.tags}"
                                    th:href="@{/home(q=${tag})}"
                                    th:text="${tag}"
                                    class="tag"
                                ></a>
                            </div>
                        </div>

                        <!-- Îã§Ïö¥Î°úÎìú -->
                        <p>
                            <span class="label">Download:</span>
                            <a
                                th:href="${portfolios.download}"
                                download
                                th:text="${portfolios.download}"
                                class="download-link"
                            ></a>
                        </p>

                        <!-- ÏïÑÏù¥ÏΩò -->
                        <aside class="summary-logo" th:if="${portfolios.icon}">
                            <figure class="logo-card" title="portfolios Logo">
                                <img
                                    th:src="${portfolios.icon}"
                                    th:alt="|${portfolios.title} ÏïÑÏù¥ÏΩò|"
                                    loading="lazy"
                                    decoding="async"
                                />
                            </figure>
                        </aside>
                    </div>
                </div>
            </div>

            <div class="comment-section">
                <h2>ÎåìÍ∏Ä</h2>

                <!-- ÌèâÍ∑† Î≥ÑÏ†ê(Î™®ÎëêÏóêÍ≤å Î≥¥ÏûÑ) -->
                <div class="rating-summary">
                    <div
                        class="stars readonly"
                        id="avgStars"
                        aria-label="ÌèâÍ∑† Î≥ÑÏ†ê"
                    ></div>
                    <span class="star-symbol">‚≠ê</span>
                    <span id="avgScore">0.0</span>
                    <span class="count">(<span id="ratingCount">0</span>)</span>
                </div>

                <!-- Î°úÍ∑∏Ïù∏ ÏÇ¨Ïö©Ïûê Ï†ÑÏö©: Î≥ÑÏ†ê + ÎåìÍ∏Ä Ìèº -->
                <div sec:authorize="isAuthenticated()">
                    <div class="rate-input">
                        <label class="rate-label">ÎÇ¥ Î≥ÑÏ†ê: </label>
                        <div
                            id="writeStars"
                            class="stars write"
                            role="radiogroup"
                            aria-label="Î≥ÑÏ†ê ÏÑ†ÌÉù(1~5)"
                        >
                            <!-- JSÍ∞Ä 5Í∞ú Î≥ÑÏùÑ ÎßåÎì§Ïñ¥Ï§çÎãàÎã§ -->
                        </div>
                        <span id="myScoreText">0</span>/5
                    </div>

                    <form id="commentForm">
                        <textarea
                            id="commentContent"
                            placeholder="ÎåìÍ∏ÄÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî..."
                            rows="4"
                            required
                        ></textarea>
                        <button type="submit">Îì±Î°ù</button>
                    </form>
                </div>

                <!-- ÎπÑÌöåÏõê ÏïàÎÇ¥ -->
                <div sec:authorize="isAnonymous()">
                    <p class="muted">
                        Î°úÍ∑∏Ïù∏ ÌõÑ ÎåìÍ∏Ä/Î≥ÑÏ†êÏùÑ ÎÇ®Í∏∏ Ïàò ÏûàÏäµÎãàÎã§.
                        <a href="/signin">Î°úÍ∑∏Ïù∏</a>
                    </p>
                </div>

                <!-- ÎåìÍ∏Ä Î¶¨Ïä§Ìä∏ -->
                <div id="commentList" class="comments"></div>
            </div>

            <!-- Î°úÍ∑∏Ïù∏ ÌïÑÏöî Î™®Îã¨ -->
            <div id="loginModal" class="login-modal" hidden>
                <div class="modal-content">
                    <p>Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌïú ÏÑúÎπÑÏä§ÏûÖÎãàÎã§.</p>
                    <button id="goSigninBtn">ÌôïÏù∏</button>
                </div>
            </div>
        </main>

        <!-- üîó JavaScript -->
        <script>
            function changeMainImage(src) {
                document.getElementById("mainImage").src = src;
            }
        </script>
        <script src="/js/portfolios/portfolios-detail.js"></script>
        <div th:replace="fragments/footer :: footer"></div>
    </body>
</html>
