<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
    <head>
        <meta charset="UTF-8" />
        <title th:text="${portfolio != null} ? ${portfolio.title} : 'Ìè¨Ìä∏Ìè¥Î¶¨Ïò§ ÏóÜÏùå'">Portfolio</title>

        </title>
        <meta name="_csrf" th:content="${_csrf.token}" />
        <meta name="_csrf_header" th:content="${_csrf.headerName}" />

        <link rel="stylesheet" href="/css/header.css" />
        <link rel="stylesheet" href="/css/portfolios/detail.css" />
        <link rel="stylesheet" href="/css/footer.css" />
        <link rel="stylesheet" href="/css/users/auth-modal.css" />
    </head>
    <body class="portfolio-detail">
        <!-- Ìó§Îçî -->
        <div th:replace="fragments/modals :: authModals"></div>
        <div th:replace="fragments/header :: header('portfolio')"></div>

        <!-- ‚úÖ ÏàòÏ†ï/ÏÇ≠Ï†ú Î≤ÑÌäº (ADMIN Ï†ÑÏö©, Ìó§Îçî ÏïÑÎûò Ïö∞Ï∏°) -->
            <div class="detail-admin-actions" sec:authorize="hasRole('ADMIN')">
                
                <!-- ÏàòÏ†ï Î≤ÑÌäº (Uiverse.io Ïä§ÌÉÄÏùº) -->
                <a th:href="@{|/portfolios/edit/${portfolio.id}|}">
                    <button class="edit-btn">edit
                        
                    </button>
                </a>
                <button type=button class="edit-btn" onclick="openDeleteModal()">delete
                    
                </button>
        
            <!-- ÏÇ≠Ï†ú Î≤ÑÌäº (Î™®Îã¨ Ïó¥Í∏∞Ïö©) -->
        
            <!-- ÏÇ≠Ï†ú Î™®Îã¨ -->
            <div id="deleteModal" class="modal" style="display:none;">
                <div class="modal-content">
                    <p>Ï†ïÎßê ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?</p>
                    <div class="modal-actions">
                        <!-- ‚úÖ ÌôïÏù∏ Î≤ÑÌäº: Ïã§Ï†ú ÏÇ≠Ï†ú Ìèº Ï†úÏ∂ú -->
                        <form id="deleteForm" th:action="@{|/portfolios/delete/${portfolio.id}|}" method="post">
                            <input type="hidden" name="_csrf" th:value="${_csrf.token}" />
                            <button type="submit" class="btn-confirm">ÌôïÏù∏</button>
                            <!-- Ï∑®ÏÜå Î≤ÑÌäº -->
                        <button type="button" class="btn-confirm" onclick="closeDeleteModal()">Ï∑®ÏÜå</button>
                        </form>
                        
                        
                    </div>
                </div>
            </div>
        </div>


        

        <main class="container">
            <!-- ‚ùå Not Found -->
            <div th:if="${notFound}" class="error-box">
                <h1>Ìè¨Ìä∏Ìè¥Î¶¨Ïò§Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.</h1>
                <a href="/home">‚Üê ÌôàÏúºÎ°ú</a>
            </div>
            
            <div class="center-box">
                <div class="title-row">
                    <h1 class="title">
                        <a
                            th:href="${portfolio.link}"
                            target="_blank"
                            th:text="${portfolio.title}"
                            >Ï†úÎ™©</a
                        >
                    </h1>
                   
                </div>
                <p class="desc" th:if="${portfolio.desc != null}" th:text="${portfolio.desc}"></p>
            </div>
            
            <!-- ‚úÖ Portfolio Content -->
            <div th:if="${portfolio != null}" class="portfolio-detail-grid">
                <!-- ÏôºÏ™Ω: Ïù¥ÎØ∏ÏßÄ -->
                <div class="gallery">
                 <!-- ÎåÄÌëú Ïù¥ÎØ∏ÏßÄ -->
                 <figure class="main-photo" 
                        th:if="${portfolio.screenshots != null and !portfolio.screenshots.isEmpty()}">
                        <img id="mainImage"
                        th:src="@{${portfolio.screenshots[0]}}"
                        alt="ÎåÄÌëú Ïù¥ÎØ∏ÏßÄ"
                        onclick="openModal(0)" />
                </figure>
                

                <!-- Ïç∏ÎÑ§Ïùº Î™©Î°ù -->
                <!-- Ïç∏ÎÑ§Ïùº Î™©Î°ù (Ï≤´ Î≤àÏß∏ Ï†úÏô∏) -->
            <div class="thumb-list"
                    th:if="${portfolio.screenshots != null and portfolio.screenshots.size() > 1}">
                    <img th:each="img, iter : ${portfolio.screenshots}"
                    th:if="${iter.index > 0}"
                    th:src="@{${img}}"
                    th:attr="data-index=${iter.index}, onclick='openModal(' + ${iter.index} + ')'"
                    alt="Ïç∏ÎÑ§Ïùº"
                    class="thumb"/>
            </div>



                </div>

                <!-- üìå Î™®Îã¨ -->
                <div id="imageModal" class="modal">
                    <span class="close" onclick="closeModal()">&times;</span>
                    <img class="modal-content" id="modalImage" />
                    <a class="prev" onclick="changeImage(-1)">&#10094;</a>
                    <a class="next" onclick="changeImage(1)">&#10095;</a>
                </div>

                <!-- Ïò§Î•∏Ï™Ω: Ï†ïÎ≥¥ -->
                <div class="info-box" th:if="${portfolio.team != null and !portfolio.team.isEmpty()}">
                    <h2>ÌåÄÏõê & Ïó≠Ìï†</h2>
                    <!-- ÌåÄÏõê Ï∂úÎ†• -->
                    <ul class="team-list">
                        <li class="team-item" th:each="member : ${portfolio.team}">
                            <div class="team-name">
                                <strong th:text="${member.memberName}">ÌåÄÏõê Ïù¥Î¶Ñ</strong>
                                <span class="role" th:text="${member.memberRole}">Ïó≠Ìï†</span>
                            </div>
                            <p class="parts" th:text="${member.parts}">Îã¥Îãπ Í∏∞Îä•</p>
                        </li>
                    </ul>
                </div>

                </div>
            </div>
            <div class="icon-bar">
                <div class="icon-left">
                    <!-- Views -->
                    <span class="view-box" title="Ï°∞ÌöåÏàò">
                        <i class="fa-solid fa-eye"></i>
                        <span class="view-label">Views :</span>
                        <span id="viewCount">0</span>
                    </span>

                    <!-- Tags -->
                    <span class="tags-box" title="ÌÉúÍ∑∏">
                        <i class="fa-solid fa-tags"></i>
                        <span class="tags-label">Tags :</span>
                        <span class="tags-list">
                          <a th:each="tag : ${portfolio.tags}"
                             th:href="@{|/portfolios?tag=${tag}|}" 
                             class="tag-item"
                             th:text="${tag}">Tag</a>
                        </span>
                        <!-- ‚úÖ ÎçîÎ≥¥Í∏∞ Î≤ÑÌäº Ï∂îÍ∞Ä -->
                        <button type="button" class="tag-more-btn" onclick="toggleTags(this)" data-expanded="false">+ ÎçîÎ≥¥Í∏∞</button>
                      </span>
                      
                      

                </div>

                <div class="icon-right">
                    <!-- Heart (Ï¢ãÏïÑÏöî) -->

                    <!-- Uiverse.io Heart -->
                    <div class="heart-container" title="Like">
                        <input type="checkbox" class="checkbox" id="likeBtn" />
                        <div class="svg-container">
                            <svg
                                viewBox="0 0 24 24"
                                class="svg-outline"
                                xmlns="http://www.w3.org/2000/svg"
                            >
                                <path
                                    d="M17.5,1.917a6.4,6.4,0,0,0-5.5,3.3,6.4,6.4,0,0,0-5.5-3.3A6.8,6.8,0,0,0,0,8.967c0,4.547,4.786,9.513,8.8,12.88a4.974,4.974,0,0,0,6.4,0C19.214,18.48,24,13.514,24,8.967A6.8,6.8,0,0,0,17.5,1.917Zm-3.585,18.4a2.973,2.973,0,0,1-3.83,0C4.947,16.006,2,11.87,2,8.967a4.8,4.8,0,0,1,4.5-5.05A4.8,4.8,0,0,1,11,8.967a1,1,0,0,0,2,0,4.8,4.8,0,0,1,4.5-5.05A4.8,4.8,0,0,1,22,8.967C22,11.87,19.053,16.006,13.915,20.313Z"
                                ></path>
                            </svg>
                            <svg
                                viewBox="0 0 24 24"
                                class="svg-filled"
                                xmlns="http://www.w3.org/2000/svg"
                            >
                                <path
                                    d="M17.5,1.917a6.4,6.4,0,0,0-5.5,3.3,6.4,6.4,0,0,0-5.5-3.3A6.8,6.8,0,0,0,0,8.967c0,4.547,4.786,9.513,8.8,12.88a4.974,4.974,0,0,0,6.4,0C19.214,18.48,24,13.514,24,8.967A6.8,6.8,0,0,0,17.5,1.917Z"
                                ></path>
                            </svg>
                            <svg
                                class="svg-celebrate"
                                width="100"
                                height="100"
                                xmlns="http://www.w3.org/2000/svg"
                            >
                                <polygon points="10,10 20,20"></polygon>
                                <polygon points="10,50 20,50"></polygon>
                                <polygon points="20,80 30,70"></polygon>
                                <polygon points="90,10 80,20"></polygon>
                                <polygon points="90,50 80,50"></polygon>
                                <polygon points="80,80 70,70"></polygon>
                            </svg>
                        </div>
                    </div>

                    <!-- Ï¢ãÏïÑÏöî Ïπ¥Ïö¥Ìä∏ -->
                    <span id="likeCount">0</span>

                    <!-- Download -->
                    <a th:if="${portfolio.download != null}" 
                        th:href="@{${portfolio.download}}"
                        download class="Btn" title="Download">

                        <svg
                            class="svgIcon"
                            viewBox="0 0 384 512"
                            height="1em"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M169.4 470.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 
                                0-45.3s-32.8-12.5-45.3 0L224 370.8 224 64c0-17.7-14.3-32-32-32s-32 14.3-32 32v306.7L54.6 
                                265.4c-12.5-12.5 -32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"
                            ></path>
                        </svg>
                        <span class="icon2"></span>
                        <span class="tooltip"></span>
                    </a>
                    <!-- Link -->
                    <a
                        th:href="${portfolio.link}"
                        target="_blank"
                        title="Link"
                        class="icon-link"
                    >
                    <img th:if="${portfolio.icon != null}" th:src="@{${portfolio.icon}}" 
                        alt="ÌôàÌéòÏù¥ÏßÄ ÏïÑÏù¥ÏΩò" 
                        class="link-icon"/>
                    </a>
                </div>
            </div>

            <div class="comment-section">
                <h2>Comments</h2>

                <!-- ÌèâÍ∑† Î≥ÑÏ†ê -->
                <div class="rating-summary">
                    <span class="avg-label">ÌèâÍ∑† Î≥ÑÏ†ê</span>
                    <div class="stars readonly" id="avgStars"></div>
                    <span id="avgScore">0.0</span>
                    <span class="count">(<span id="ratingCount">0</span>)</span>
                </div>

                <!-- Î°úÍ∑∏Ïù∏ ÏÇ¨Ïö©Ïûê -->
                <div sec:authorize="isAuthenticated()">
                    <form id="commentForm" class="comment-form">
                        <div class="rate-input">
                            <label class="rate-label">Î≥ÑÏ†ê:</label>
                            <div class="rating">
                                <input
                                    value="5"
                                    name="rate"
                                    id="star5"
                                    type="radio"
                                />
                                <label for="star5" title="5Ï†ê"></label>

                                <input
                                    value="4"
                                    name="rate"
                                    id="star4"
                                    type="radio"
                                />
                                <label for="star4" title="4Ï†ê"></label>

                                <input
                                    value="3"
                                    name="rate"
                                    id="star3"
                                    type="radio"
                                />
                                <label for="star3" title="3Ï†ê"></label>

                                <input
                                    value="2"
                                    name="rate"
                                    id="star2"
                                    type="radio"
                                />
                                <label for="star2" title="2Ï†ê"></label>

                                <input
                                    value="1"
                                    name="rate"
                                    id="star1"
                                    type="radio"
                                />
                                <label for="star1" title="1Ï†ê"></label>
                            </div>
                            <span id="myScoreText">0</span>/5
                        </div>
                        <input
                            type="text"
                            id="commentContent"
                            placeholder="Ìïú Ï§Ñ ÌèâÍ∞ÄÎ•º ÎÇ®Í≤®Ï£ºÏÑ∏Ïöî..."
                            required
                        />
                        <button type="submit">Îì±Î°ù</button>
                    </form>
                </div>

                <!-- ÎπÑÌöåÏõê ÏïàÎÇ¥ -->
                <div sec:authorize="isAnonymous()">
                    <p class="muted">
                        Î°úÍ∑∏Ïù∏ ÌõÑ ÎåìÍ∏Ä/Î≥ÑÏ†êÏùÑ ÎÇ®Í∏∏ Ïàò ÏûàÏäµÎãàÎã§.
                        <a href="/signin">Î°úÍ∑∏Ïù∏</a>
                    </p>
                </div>

                <!-- ÎåìÍ∏Ä Î¶¨Ïä§Ìä∏ -->
                <div id="commentList" class="comments">
                    <div class="comment">
                        <div class="meta">
                            <span class="author">ÏùµÎ™Ö</span>
                            <span class="date">2025-08-03</span>
                        </div>
                        <div class="stars readonly">‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ</div>
                        <p class="content">
                            ÎåÄÏ≤¥Ï†ÅÏúºÎ°ú ÍπîÎÅîÌïú ÎäêÎÇåÏù¥ÎùºÏÑú Ï¢ãÏäµÎãàÎã§.
                        </p>
                    </div>

                    <div class="comment">
                        <div class="meta">
                            <span class="author">ÏùµÎ™Ö</span>
                            <span class="date">2025-09-02</span>
                        </div>
                        <div class="stars readonly">‚≠ê‚≠ê‚≠ê‚òÜ‚òÜ</div>
                        <p class="content">Î¨¥ÎÇúÌïú ÎäêÎÇåÏûÖÎãàÎã§.</p>
                    </div>

                    <div class="comment">
                        <div class="meta">
                            <span class="author">ÏùµÎ™Ö</span>
                            <span class="date">2025-09-12</span>
                        </div>
                        <div class="stars readonly">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                        <p class="content">Ïûò ÎßåÎì§ÏóàÏäµÎãàÎã§.</p>
                    </div>
                </div>
            </div>

            <!-- ÎåìÍ∏Ä Î¶¨Ïä§Ìä∏ -->
        </main>

        <!-- üîó JavaScript -->
        <script>
            function changeMainImage(src) {
                document.getElementById("mainImage").src = src;
            }
        </script>
        <script src="/js/portfolios/portfolios-detail.js"></script>
        <div th:replace="fragments/footer :: footer"></div>
    </body>
</html>
