<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ê´€ë¦¬ì í˜ì´ì§€ â€“ kafolio</title>
  <link rel="stylesheet" href="/css/admin/admin.css" />
  <link rel="stylesheet" href="/css/header.css" />
</head>
<body data-page="admin">
  <div th:replace="fragments/header :: site-header"></div>
  <div class="admin-layout">
    <!-- ì‚¬ì´ë“œë°” -->
    <aside class="sidebar">
      <div class="sidebar-brand">ê´€ë¦¬ì</div>
      <nav class="sidebar-nav">
        <ul>
          <li><a href="#" class="active" data-page="dashboard">ëŒ€ì‹œë³´ë“œ</a></li>
          <li><a href="#" data-page="filios">Filios ê´€ë¦¬</a></li>
          <li><a href="#" data-page="portfolios">Portfolios ê´€ë¦¬</a></li>
          <li><a href="#" data-page="teams">íŒ€ ê´€ë¦¬</a></li>
          <li><a href="#" data-page="users">ìœ ì € ê´€ë¦¬</a></li>
        </ul>
      </nav>
    </aside>

    <!-- ë©”ì¸ -->
    <main class="main-content">
      <header class="admin-header">
        <h1 id="page-title">ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</h1>
        <div class="header-actions">
          <button class="btn ghost">ğŸ”” ì•Œë¦¼</button>
        </div>
      </header>

      <section id="page-content" class="content-area">
        <!-- ê¸°ë³¸ ëŒ€ì‹œë³´ë“œ -->
        <div class="dashboard">
          <div class="card"><h3>ì´ ìœ ì € ìˆ˜</h3><p>124ëª…</p></div>
          <div class="card"><h3>ë“±ë¡ëœ Portfolios</h3><p>57ê°œ</p></div>
          <div class="card"><h3>íŒ€ ìˆ˜</h3><p>12ê°œ</p></div>
          <div class="card"><h3>Filios</h3><p>34ê°œ</p></div>
        </div>
      </section>
    </main>
  </div>

  <script>
// =======================
// í˜ì´ì§€ ì •ì˜
// =======================
const pages = {
  dashboard: `
    <div class="dashboard">
      <div class="card"><h3>ì´ ìœ ì € ìˆ˜</h3><p>124ëª…</p></div>
      <div class="card"><h3>ë“±ë¡ëœ Portfolios</h3><p>57ê°œ</p></div>
      <div class="card"><h3>íŒ€ ìˆ˜</h3><p>12ê°œ</p></div>
      <div class="card"><h3>Filios</h3><p>34ê°œ</p></div>
    </div>
  `,
  filios: `
    <section class="list-section">
      <h2>Filios ê´€ë¦¬</h2>
      <table class="list-table">
        <thead>
          <tr><th>ID</th><th>íŒŒì¼ëª…</th><th>ì—…ë¡œë”</th><th>ìƒíƒœ</th><th>ì—…ë¡œë“œì¼</th><th>ê´€ë¦¬</th></tr>
        </thead>
        <tbody>
          <tr>
            <td>F1</td><td>banner.png</td><td>admin</td><td>í™œì„±</td><td>2025-09-06</td>
            <td>
              <button class="btn ghost">ìˆ˜ì •</button>
              <button class="btn primary">ì‚­ì œ</button>
            </td>
          </tr>
        </tbody>
      </table>
    </section>
  `,
  portfolios: `
    <section class="list-section">
      <h2>Portfolios ê´€ë¦¬</h2>
      <table class="list-table">
        <thead>
          <tr><th>ID</th><th>ì œëª©</th><th>ì‘ì„±ì</th><th>íƒœê·¸</th><th>ë“±ë¡ì¼</th><th>ê´€ë¦¬</th></tr>
        </thead>
        <tbody>
          <tr>
            <td>P1</td><td>ì›¹ í¬íŠ¸í´ë¦¬ì˜¤</td><td>ë°•ë²”ìˆ˜</td><td>#Landing</td><td>2025-09-05</td>
            <td>
              <button class="btn ghost">ìˆ˜ì •</button>
              <button class="btn primary">ì‚­ì œ</button>
            </td>
          </tr>
        </tbody>
      </table>
    </section>
  `,
  users: `
    <section class="list-section">
      <h2>ìœ ì € ê´€ë¦¬</h2>
      <table class="list-table">
        <thead>
          <tr><th>ID</th><th>ì´ë©”ì¼</th><th>ë‹‰ë„¤ì„</th><th>ì—­í• </th><th>ê°€ì…ì¼</th><th>ê´€ë¦¬</th></tr>
        </thead>
        <tbody>
          <tr>
            <td>1</td><td>user1@example.com</td><td>ë²”ìˆ˜</td><td>USER</td><td>2025-09-01</td>
            <td>
              <button class="btn ghost">ìˆ˜ì •</button>
              <button class="btn primary">ì‚­ì œ</button>
            </td>
          </tr>
          <tr>
            <td>2</td><td>admin@example.com</td><td>ê´€ë¦¬ì</td><td>ADMIN</td><td>2025-09-02</td>
            <td>
              <button class="btn ghost">ìˆ˜ì •</button>
              <button class="btn primary">ì‚­ì œ</button>
            </td>
          </tr>
        </tbody>
      </table>
    </section>
  `,
  teams: `
    <section class="list-section">
      <h2>íŒ€ ê´€ë¦¬</h2>
      <div class="team-manager">
        <!-- ì¢Œì¸¡: íšŒì› ëª©ë¡ -->
        <div class="team-column">
          <h3>íšŒì› ëª©ë¡</h3>
          <input type="search" id="memberSearch" placeholder="íšŒì› ê²€ìƒ‰" />
          <ul id="memberList" class="list-box"></ul>
        </div>

        <!-- ì¤‘ì•™: ì´ë™ ë²„íŠ¼ -->
        <div class="team-controls">
          <button id="btnAdd" class="btn primary">â–¶</button>
          <button id="btnRemove" class="btn ghost">â—€</button>
        </div>

        <!-- ìš°ì¸¡: ì„ íƒëœ íŒ€ì› -->
        <div class="team-column">
          <h3>ì„ íƒëœ íŒ€ì›</h3>
          <ul id="selectedList" class="list-box"></ul>
          <input type="text" id="teamName" placeholder="íŒ€ ì´ë¦„ ì…ë ¥" />
          <button id="btnSaveTeam" class="btn primary full">íŒ€ ì €ì¥</button>
        </div>
      </div>

      <div class="team-result">
        <h3>ì €ì¥ëœ íŒ€ ëª©ë¡</h3>
        <ul id="teamList"></ul>
      </div>

      <!-- ì‚­ì œ í™•ì¸ ëª¨ë‹¬ -->
      <dialog id="confirmModal" class="modal">
        <div class="modal-content">
          <p>ì •ë§ ì´ íŒ€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p>
          <div class="modal-actions">
            <button id="confirmYes" class="btn primary">ì‚­ì œ</button>
            <button id="confirmNo" class="btn ghost">ì·¨ì†Œ</button>
          </div>
        </div>
      </dialog>
    </section>
  `
};

// =======================
// ë©¤ë²„ ë°ì´í„° (ì „ì²´ ëª©ë¡)
// =======================
const allMembers = [
  { id: 1, name: "ë°•ë²”ìˆ˜" },
  { id: 2, name: "ê¹€ì² ìˆ˜" },
  { id: 3, name: "ì´ì˜í¬" },
  { id: 4, name: "John Doe" },
  { id: 5, name: "Jane Smith" },
];

// =======================
// ì‚¬ì´ë“œë°” ì´ë²¤íŠ¸
// =======================
const sidebarLinks = document.querySelectorAll(".sidebar-nav a");
const content = document.getElementById("page-content");
const pageTitle = document.getElementById("page-title");

sidebarLinks.forEach((link) => {
  link.addEventListener("click", (e) => {
    e.preventDefault();
    sidebarLinks.forEach((l) => l.classList.remove("active"));
    link.classList.add("active");
    const page = link.dataset.page;

    content.innerHTML = pages[page];
    pageTitle.textContent = link.textContent;

    if (page === "teams") {
      initTeamManager();
    }
  });
});

// =======================
// íŒ€ ê´€ë¦¬ ê¸°ëŠ¥
// =======================
function initTeamManager() {
  const memberList = document.getElementById("memberList");
  const selectedList = document.getElementById("selectedList");
  const btnAdd = document.getElementById("btnAdd");
  const btnRemove = document.getElementById("btnRemove");
  const btnSave = document.getElementById("btnSaveTeam");
  const teamName = document.getElementById("teamName");
  const teamList = document.getElementById("teamList");
  const search = document.getElementById("memberSearch");

  const confirmModal = document.getElementById("confirmModal");
  const confirmYes = document.getElementById("confirmYes");
  const confirmNo = document.getElementById("confirmNo");

  let editingTeam = null;
  let teamToDelete = null;

  // ì „ì²´ ë©¤ë²„ ë Œë”ë§ í•¨ìˆ˜
  function renderAllMembers(excluded = []) {
    memberList.innerHTML = "";
    allMembers.forEach(m => {
      if (!excluded.includes(m.name)) {
        const li = document.createElement("li");
        li.textContent = m.name;
        li.dataset.id = m.id;
        memberList.appendChild(li);
      }
    });
  }

  renderAllMembers();

  // ë©¤ë²„ ì„ íƒ
  memberList.addEventListener("click", (e) => {
    if (e.target.tagName === "LI") {
      [...memberList.children].forEach(li => li.classList.remove("selected"));
      e.target.classList.add("selected");
    }
  });

  selectedList.addEventListener("click", (e) => {
    if (e.target.tagName === "LI") {
      [...selectedList.children].forEach(li => li.classList.remove("selected"));
      e.target.classList.add("selected");
    }
  });

  // ì¶”ê°€
  btnAdd.addEventListener("click", () => {
    const selected = memberList.querySelector(".selected");
    if (selected) {
      selected.classList.remove("selected");
      selectedList.appendChild(selected);
    }
  });

  // ì œê±°
  btnRemove.addEventListener("click", () => {
    const selected = selectedList.querySelector(".selected");
    if (selected) {
      selected.classList.remove("selected");
      selectedList.removeChild(selected);
      renderAllMembers([...selectedList.children].map(li => li.textContent));
    }
  });

  // íŒ€ ì €ì¥
  btnSave.addEventListener("click", () => {
    const name = teamName.value.trim();
    if (!name) {
      alert("íŒ€ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”!");
      return;
    }
    const members = [...selectedList.children].map(li => li.textContent);
    if (members.length === 0) {
      alert("íŒ€ì›ì„ ì„ íƒí•˜ì„¸ìš”!");
      return;
    }

    if (editingTeam) {
      editingTeam.querySelector(".team-name").textContent = name;
      editingTeam.querySelector(".team-members").textContent = members.join(", ");
      editingTeam = null;
    } else {
      const li = document.createElement("li");
      li.innerHTML = `
        <div class="team-name">${name}</div>
        <div class="team-members">${members.join(", ")}</div>
        <div class="team-meta">${new Date().toLocaleDateString()}</div>
        <div class="team-actions">
          <button class="btn ghost btn-edit">ìˆ˜ì •</button>
          <button class="btn primary btn-delete">ì‚­ì œ</button>
        </div>
      `;
      teamList.appendChild(li);
    }

    teamName.value = "";
    selectedList.innerHTML = "";
    renderAllMembers();
  });

  // íŒ€ ìˆ˜ì •/ì‚­ì œ ì´ë²¤íŠ¸
  teamList.addEventListener("click", (e) => {
    const li = e.target.closest("li");
    if (!li) return;

    if (e.target.classList.contains("btn-edit")) {
      const name = li.querySelector(".team-name").textContent;
      const members = li.querySelector(".team-members").textContent.split(", ");
      teamName.value = name;

      selectedList.innerHTML = "";
      members.forEach((m, idx) => {
        const memberLi = document.createElement("li");
        memberLi.textContent = m;
        memberLi.dataset.id = idx + 100;
        selectedList.appendChild(memberLi);
      });

      renderAllMembers(members);
      editingTeam = li;
    }

    if (e.target.classList.contains("btn-delete")) {
      teamToDelete = li;
      confirmModal.showModal();
    }
  });

  // ëª¨ë‹¬ ì´ë²¤íŠ¸
  confirmYes.addEventListener("click", () => {
    if (teamToDelete) {
      teamToDelete.remove();
      teamToDelete = null;
    }
    confirmModal.close();
  });

  confirmNo.addEventListener("click", () => {
    teamToDelete = null;
    confirmModal.close();
  });

  // ê²€ìƒ‰
  search.addEventListener("input", () => {
    const keyword = search.value.toLowerCase();
    [...memberList.children].forEach(li => {
      li.style.display = li.textContent.toLowerCase().includes(keyword) ? "" : "none";
    });
  });
}

  </script>
</body>
</html>
